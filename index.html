<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë°ì¼ë¦¬ ë¸Œë¦¬í•‘</title>
  <style>
    :root {
      --bg: #fafafa;
      --fg: #1a1a1a;
      --accent: #2563eb;
      --muted: #6b7280;
      --border: #e5e7eb;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Apple SD Gothic Neo', -apple-system, sans-serif; background: var(--bg); color: var(--fg); line-height: 1.7; font-size: 16px; }
    header { border-bottom: 1px solid var(--border); padding: 1.5rem 0 0; text-align: center; }
    header h1 { font-size: 1.4rem; font-weight: 700; }
    header p { color: var(--muted); font-size: 0.875rem; margin-top: 0.25rem; }
    nav { display: flex; justify-content: center; gap: 0.5rem; padding: 1rem 0 0; }
    nav button { background: none; border: 1px solid var(--border); border-radius: 6px; padding: 0.35rem 0.9rem; font-size: 0.82rem; cursor: pointer; color: var(--muted); font-weight: 600; }
    nav button.active { background: var(--accent); color: #fff; border-color: var(--accent); }
    main { max-width: 720px; margin: 0 auto; padding: 2rem 1.5rem; }
    .briefing { border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem; background: #fff; }
    .briefing-date { font-size: 0.8rem; font-weight: 600; color: var(--accent); letter-spacing: 0.05em; margin-bottom: 0.75rem; }
    .section { margin-bottom: 1.25rem; }
    .section-title { font-size: 0.8rem; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.5rem; padding-bottom: 0.25rem; border-bottom: 1px solid var(--border); }
    .news-item { margin-bottom: 0.75rem; padding-left: 0.75rem; border-left: 2px solid var(--border); }
    .news-item p { font-size: 0.9rem; }
    .news-item .source { font-size: 0.75rem; color: var(--muted); margin-top: 0.2rem; }
    .news-item .source a { color: var(--accent); text-decoration: none; }
    .news-item .source a:hover { text-decoration: underline; }
    .point { background: #eff6ff; border-left: 3px solid var(--accent); padding: 0.75rem 1rem; border-radius: 0 4px 4px 0; font-size: 0.9rem; font-weight: 500; }
    .investment-advice { background: #fffbeb; border: 1px solid #fcd34d; border-radius: 8px; padding: 1rem 1.25rem; margin-top: 1.25rem; }
    .investment-advice .advice-title { font-size: 0.8rem; font-weight: 700; color: #92400e; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem; }
    .advice-section { margin-bottom: 0.75rem; }
    .advice-section-label { font-size: 0.78rem; font-weight: 700; color: #78350f; margin-bottom: 0.3rem; }
    .investment-advice p { font-size: 0.9rem; line-height: 1.7; }
    .investment-advice .disclaimer { font-size: 0.72rem; color: #a16207; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid #fde68a; }
    .monthly-badge { display: inline-block; background: #dbeafe; color: #1d4ed8; font-size: 0.72rem; font-weight: 700; padding: 0.15rem 0.5rem; border-radius: 4px; margin-bottom: 0.5rem; }
    /* í˜ì´ì§€ë„¤ì´ì…˜ */
    .pagination { display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin: 1.5rem 0; flex-wrap: wrap; }
    .pagination button { border: 1px solid var(--border); background: #fff; border-radius: 6px; padding: 0.4rem 0.8rem; font-size: 0.85rem; cursor: pointer; color: var(--fg); }
    .pagination button:hover { border-color: var(--accent); color: var(--accent); }
    .pagination button.active { background: var(--accent); color: #fff; border-color: var(--accent); font-weight: 700; }
    .pagination button:disabled { opacity: 0.35; cursor: not-allowed; }
    .pagination .page-info { font-size: 0.82rem; color: var(--muted); padding: 0 0.5rem; }
    footer { text-align: center; padding: 2rem; color: var(--muted); font-size: 0.8rem; border-top: 1px solid var(--border); }
    @media (max-width: 600px) { main { padding: 1rem; } .briefing { padding: 1rem; } }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ“° ë°ì¼ë¦¬ ë¸Œë¦¬í•‘</h1>
    <p>ë§¤ì¼ ì•„ì¹¨ 8ì‹œ, ê¸€ë¡œë²Œ ê²½ì œÂ·ê¸°ìˆ Â·ê³¼í•™ ë‰´ìŠ¤</p>
    <nav>
      <button class="active" onclick="showTab('daily', this)">ğŸ“… Daily</button>
      <button onclick="showTab('monthly', this)">ğŸ“Š Monthly</button>
    </nav>
  </header>

  <main>
    <div id="tab-daily">
      <div id="briefings-container"></div>
      <div class="pagination" id="pagination"></div>
    </div>
    <div id="tab-monthly" style="display:none">
      <div id="monthly-list"></div>
    </div>
  </main>

  <footer>
    Powered by Jini Â· <a href="https://jinik0207.github.io/daily-briefing/" style="color:inherit">jinik0207.github.io/daily-briefing</a>
  </footer>

  <script>
    const PER_PAGE = 7;
    let allDates = [];
    let currentPage = 1;

    // URL íŒŒë¼ë¯¸í„°ì—ì„œ í˜ì´ì§€ ì½ê¸°
    const params = new URLSearchParams(location.search);
    if (params.get('page')) currentPage = parseInt(params.get('page')) || 1;

    // Daily ë¸Œë¦¬í•‘ ë¡œë“œ
    async function loadDaily() {
      try {
        const res = await fetch('briefings/index.json?v=' + Date.now());
        allDates = await res.json();
        renderPage(currentPage);
      } catch(e) {
        document.getElementById('briefings-container').innerHTML =
          '<p style="color:#6b7280;text-align:center;padding:3rem 0;">ë¸Œë¦¬í•‘ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    async function renderPage(page) {
      currentPage = page;
      const totalPages = Math.ceil(allDates.length / PER_PAGE);
      const start = (page - 1) * PER_PAGE;
      const pageDates = allDates.slice(start, start + PER_PAGE);

      // URL ì—…ë°ì´íŠ¸
      const url = new URL(location.href);
      url.searchParams.set('page', page);
      history.replaceState(null, '', url);

      // ë¸Œë¦¬í•‘ ë¡œë“œ
      const container = document.getElementById('briefings-container');
      container.innerHTML = '<p style="color:#6b7280;text-align:center;padding:2rem 0;">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>';

      try {
        const briefings = await Promise.all(
          pageDates.map(d => fetch(`briefings/${d}.json?v=` + Date.now()).then(r => r.json()))
        );
        container.innerHTML = briefings.map(b => `
          <article class="briefing">
            <div class="briefing-date">${b.date}</div>
            <div class="briefing-content">${b.html}</div>
          </article>
        `).join('') || '<p style="color:#6b7280;text-align:center;padding:3rem 0;">ì•„ì§ ë¸Œë¦¬í•‘ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      } catch(e) {
        container.innerHTML = '<p style="color:#6b7280;text-align:center;padding:2rem 0;">ë¡œë“œ ì˜¤ë¥˜</p>';
      }

      // í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
      renderPagination(page, totalPages);
      window.scrollTo(0, 0);
    }

    function renderPagination(page, total) {
      if (total <= 1) { document.getElementById('pagination').innerHTML = ''; return; }
      let html = '';
      html += `<button onclick="renderPage(${page-1})" ${page===1?'disabled':''}>â† ì´ì „</button>`;

      // í˜ì´ì§€ ë²ˆí˜¸ (ìµœëŒ€ 5ê°œ í‘œì‹œ)
      let start = Math.max(1, page - 2);
      let end = Math.min(total, start + 4);
      if (end - start < 4) start = Math.max(1, end - 4);

      if (start > 1) html += `<button onclick="renderPage(1)">1</button>${start>2?'<span class="page-info">â€¦</span>':''}`;
      for (let i = start; i <= end; i++) {
        html += `<button class="${i===page?'active':''}" onclick="renderPage(${i})">${i}</button>`;
      }
      if (end < total) html += `${end<total-1?'<span class="page-info">â€¦</span>':''}<button onclick="renderPage(${total})">${total}</button>`;

      html += `<button onclick="renderPage(${page+1})" ${page===total?'disabled':''}>ë‹¤ìŒ â†’</button>`;
      html += `<span class="page-info">${page} / ${total} í˜ì´ì§€</span>`;
      document.getElementById('pagination').innerHTML = html;
    }

    // Monthly ë¦¬í¬íŠ¸ ë¡œë“œ
    let monthlyLoaded = false;
    async function loadMonthly() {
      if (monthlyLoaded) return;
      monthlyLoaded = true;
      try {
        const res = await fetch('monthly/index.json?v=' + Date.now());
        const months = await res.json();
        if (!months.length) {
          document.getElementById('monthly-list').innerHTML =
            '<p style="color:#6b7280;text-align:center;padding:3rem 0;">ì•„ì§ ì›”ê°„ ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
          return;
        }
        const reports = await Promise.all(
          months.map(m => fetch(`monthly/${m}.json?v=` + Date.now()).then(r => r.json()))
        );
        document.getElementById('monthly-list').innerHTML = reports.map(r => `
          <article class="briefing">
            <div class="monthly-badge">MONTHLY REPORT</div>
            <div class="briefing-date">${r.month}</div>
            <div class="briefing-content">${r.html}</div>
          </article>
        `).join('');
      } catch(e) {
        document.getElementById('monthly-list').innerHTML =
          '<p style="color:#6b7280;text-align:center;padding:3rem 0;">ì›”ê°„ ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    function showTab(tab, btn) {
      document.getElementById('tab-daily').style.display = tab === 'daily' ? '' : 'none';
      document.getElementById('tab-monthly').style.display = tab === 'monthly' ? '' : 'none';
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      if (tab === 'monthly') loadMonthly();
    }

    // ì´ˆê¸° ë¡œë“œ
    loadDaily();
  </script>
</body>
</html>
